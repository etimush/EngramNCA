<d-article class="center">


    <a class="marker" href="#section-1" id="section-1"></a>
    <h2>Introduction</h2>

%% contents.html

    <p>Sample ref: <d-cite key="mercier2011humans"></d-cite></p>
    <h4>Sample math:</h4>
    <d-math block>
      c = \pm \sqrt{ \sum_{i=0}^{n}{a^{222} + b^2}}
    </d-math>
    <p>Sample footnote <d-footnote>Footnote</d-footnote> </p>
    <a class="marker" href="#section-2" id="section-2"></a>
    <h2>Model(s)</h2>
    <p>Description of both models, including illustrations of their architecture and how they interact.</p>

    <p>Taking inspiration from RNA memory transfer in planarians and Aplysia californica, we augment the NCA hidden state with a "private tape".
    Instead of extending the classic NCA model by appending the tape to the hidden states, we choose to sacrifice hidden states by privatizing them, this ensures that any
    improvements seen are not due to an increase in model size. The theory here is that the private tape augmentation can be exploited to encode different modalities of behaviour,
    such as growing different shapes or representing different calculations.</p>

    <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/gene.drawio.svg"; id="figure-augment"
          style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>NCA augmentation through gene embedding channels.</figcaption>

    <p>We chose to encode different "primitives" in the tape through binary representation</p>
    <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/embedding.drawio.svg"; id="figure-embed"
          style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption> Binary embedding of different primitives.</figcaption>
    <a class="marker" href="#section-2.1" id="section-2.1"></a>
    <h3>GeneCA</h3>



      <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/Gene.drawio.svg"; id="figure-div"
          style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>One step of the GeneCA</figcaption>


    <a class="marker" href="#section-2.2" id="section-2.2"></a>
    <h3>GenePropCA</h3>

    <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/GeneProp1.drawio.svg"
      style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>One step of the GenePropCA</figcaption>




    <a class="marker" href="#section-2.3" id="section-2.3"></a>
    <h3>Ensemble</h3>

    <p>The ensemble model uses the GeneCA and GenePropCA to produce the final morphology. The GeneCA works without the GenePropCA and will produce the primitives. The
    GenePropCA is dependent on the GeneCA as its parameters are trained to manipulate the GeneCA dynamics. At step N, the state of the CA is passed to the GeneCA, where it only modifies the visible and hidden channels
    to produce an intermediate state, the intermediate step is then passed to the GenePropCA, where only the gene encoding channels are modified to produce step N+1. The idea here is for the
    GenePropCA to learn to exploit the gene embedded dynamics of the GeneCA to produce more complex morphologies than that found in the GeneCA.</p>

    <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/Enseble.drawio.svg"
      style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>One step of the ensemble, GeneCA + GenePropCA</figcaption>


    <a class="marker" href="#section-3" id="section-3"></a>
    <h2>Hierarchical Growth Task</h2>
    <p>A description of both growing task (primitives and morphologies). </p>

    <a class="marker" href="#section-3.1" id="section-3.1"></a>
    <h3>Growing Coexisting Primitives</h3>

    <a class="marker" href="#section-3.2" id="section-3.2"></a>
    <h3>Growing Morphologies from Primitives</h3>

    <a class="marker" href="#section-4" id="section-4"></a>
    <h2>Training Procedure</h2>
    <p>A description of the training procedure. Talk about two training phases, the special pooling method to train multiple DNA at once
    and how the GeneNCa Weights are frozen when training the GeneProp NCA</p>

    <a class="marker" href="#section-4.1" id="section-4.1"></a>
    <h3>GeneCA Training</h3>
    <p>GeneCA training is similar to the pool-training procedure presented in <d-cite key="mordvintsev2020growing"></d-cite>. However, to enable the gene encoding of multiple primitives,
    each gene-primitive pair is given its own pool to sample from and update. Additionally, the target image becomes a target batch consisting of n-repetitions of each image,
    where n is a factor of the batch size. It is important to keep the batch size as a multiple of the number of primitives to avoid training bias towards one primitive.</p>
    <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/Training.drawio.svg"
      style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>Training loop for multi-image batch training</figcaption>

    <a class="marker" href="#section-4.2" id="section-4.2"></a>
    <h3>GenePropCA Training</h3>
     <figure style="text-align: center; margin: 2rem 0;"><img playsinline src="figures/training_prop.drawio.svg"
      style="width:100%; border: 0px solid rgba(0, 0, 0, 0.2);" /></figure><figcaption>Training loop for GenePropCA</figcaption>
    <a class="marker" href="#section-5" id="section-5"></a>
    <h2>Results</h2>
    <p>Results split into sections based on relevance, will probably have a similar split aligning with the experiments conducted every week. The results Should not discuss the
    significance of the results, they should merely state what was observed. Include videos.</p>

    <a class="marker" href="#section-5.1" id="section-5.1"></a>
    <h3>Growing Coexisting Primitives </h3>

    <figure style="text-align: center; margin: 2rem 0;"><video loop autoplay playsinline muted width="640px"; src="figures/Primitives.webm" style="width:60%; border: 0px solid rgba(0, 0, 0, 0.2);"/></figure><figcaption>Growing simple primitives.</figcaption>
    <figure style="text-align: center; margin: 2rem 0;"><video loop autoplay playsinline muted width="640px"; src="figures/Individuals.webm" style="width:60%; border: 0px solid rgba(0, 0, 0, 0.2);"/></figure><figcaption>Untrained behaviour: primitives displaying strong individuality.</figcaption>
    <figure style="text-align: center; margin: 2rem 0;"><video loop autoplay playsinline muted width="640px"; src="figures/Mixed.webm" style="width:60%; border: 0px solid rgba(0, 0, 0, 0.2);"/></figure><figcaption>Untrained behaviour: out-of-training generative capabilities from mixing genes.</figcaption>




    <a class="marker" href="#section-5.2" id="section-5.2"></a>
    <h3>Growing Morphologies from Primitives </h3>

    <a class="marker" href="#section-5.3" id="section-5.3"></a>
    <h3>Growing Coexisting Morphologies from Primitives </h3>

    <a class="marker" href="#section-6" id="section-6"></a>
    <h2>Related Work</h2>

    <a class="marker" href="#section-7" id="section-7"></a>
    <h2>Discussion</h2>
    <p>A discussion of the results, their significance  and meaning.</p>

    <a class="marker" href="#section-8" id="section-8"></a>
    <h2>Conclusion </h2>
    <p>Conclusion to wrap up the paper summarising what was done and how the results are significant</p>



    <!-- if something breaks later on, add back script section form ref.html -->


  </d-article>